<pre class="code">
<span class="srcline"><span class="lineno"><a href="49,1"> 1</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,3"> 3</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T18U3">M</span>,<span class="var type1" id="S3T18U4">Mh</span>,<span class="var type1" id="S4T19U5">mi</span>,<span class="var type1" id="S5T19U6">mhi</span>] = <span class="message warning" id="M2F107C">LineMask_limitedangleRange</span>(<span class="mxinfo" id="T2:U5"><span class="mxinfo" id="T2:U6"><span class="var type1" id="S6T2U9">L</span></span></span>,<span class="var type1" id="S7T2U10">N</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="49,4"> 4</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,5"> 5</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,6"> 6</a></span><span class="line"><span class="mxinfo" id="T14:U9"><span class="var type1" id="S8T14U13">thc</span> = <span class="mxinfo" id="T14:U11">linspace(0, pi-pi/<span class="var type1" id="S6T2U23">L</span>, <span class="var type1" id="S6T2U24">L</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,7"> 7</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,8"> 8</a></span><span class="line"><span class="mxinfo" id="T18:U14"><span class="var type1" id="S2T18U27">M</span> = <span class="mxinfo" id="T18:U16">zeros(<span class="var type1" id="S7T2U30">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,10">10</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,11">11</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S12T2U33">ll</span> = <span class="mxinfo" id="T2:U19">1</span>:<span class="mxinfo" id="T2:U20"><span class="var type1" id="S6T2U36">L</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,12">12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,13">13</a></span><span class="line">    <span class="keyword">if</span> (((<span class="mxinfo" id="T7:U22"><span class="mxinfo" id="T2:U23"><span class="var type1" id="S8T14U46">thc</span>(<span class="var type1" id="S12T2U47">ll</span>)</span> &gt;= <span class="mxinfo" id="T2:U26"><span class="mxinfo" id="T2:U27">pi</span>/<span class="mxinfo" id="T2:U28">3</span></span></span>)           &amp; (<span class="mxinfo" id="T7:U29"><span class="mxinfo" id="T2:U30"><span class="var type1" id="S8T14U55">thc</span>(<span class="var type1" id="S12T2U56">ll</span>)</span> &lt;= (<span class="mxinfo" id="T2:U33"><span class="mxinfo" id="T2:U34"><span class="mxinfo" id="T2:U35">pi</span>/<span class="mxinfo" id="T2:U36">3</span></span>+<span class="mxinfo" id="T2:U37"><span class="mxinfo" id="T2:U38">pi</span>/<span class="mxinfo" id="T2:U39">18</span></span></span>)</span>)) | ((<span class="mxinfo" id="T7:U40"><span class="mxinfo" id="T2:U41"><span class="var type1" id="S8T14U72">thc</span>(<span class="var type1" id="S12T2U73">ll</span>)</span> &gt;= (<span class="mxinfo" id="T2:U44"><span class="mxinfo" id="T2:U45"><span class="mxinfo" id="T2:U46">2*pi</span>/<span class="mxinfo" id="T2:U47">3</span></span>-<span class="mxinfo" id="T2:U48"><span class="mxinfo" id="T2:U49">pi</span>/<span class="mxinfo" id="T2:U50">18</span></span></span>)</span>) &amp; (<span class="mxinfo" id="T7:U51"><span class="mxinfo" id="T2:U52"><span class="var type1" id="S8T14U89">thc</span>(<span class="var type1" id="S12T2U90">ll</span>)</span> &lt;= <span class="mxinfo" id="T2:U55"><span class="mxinfo" id="T2:U56">2*pi</span>/<span class="mxinfo" id="T2:U57">3</span></span></span>)))</span></span>
<span class="srcline"><span class="lineno"><a href="49,14">14</a></span><span class="line">  		<span class="mxinfo" id="T17:U58"><span class="var type1" id="S13T17U99">xc</span> = <span class="mxinfo" id="T17:U60"><span class="mxinfo" id="T17:U61"><span class="mxinfo" id="T17:U62">round(<span class="mxinfo" id="T17:U63"><span class="mxinfo" id="T2:U64">cot(<span class="mxinfo" id="T2:U65"><span class="var type1" id="S8T14U108">thc</span>(<span class="var type1" id="S12T2U109">ll</span>)</span>)</span>*(<span class="mxinfo" id="T17:U68"><span class="mxinfo" id="T2:U69"><span class="mxinfo" id="T2:U70"><span class="mxinfo" id="T2:U71">-<span class="var type1" id="S7T2U115">N</span></span>/<span class="mxinfo" id="T2:U73">2</span></span>+<span class="mxinfo" id="T2:U74">1</span></span>:<span class="mxinfo" id="T2:U75"><span class="mxinfo" id="T2:U76"><span class="var type1" id="S7T2U120">N</span>/<span class="mxinfo" id="T2:U78">2</span></span>-<span class="mxinfo" id="T2:U79">1</span></span></span>)</span>)</span>+<span class="mxinfo" id="T2:U80"><span class="var type1" id="S7T2U124">N</span>/<span class="mxinfo" id="T2:U82">2</span></span></span>+<span class="mxinfo" id="T2:U83">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,15">15</a></span><span class="line">		<span class="keyword">for</span> <span class="var type1" id="S16T2U129">nn</span> = <span class="mxinfo" id="T2:U85">1</span>:<span class="mxinfo" id="T2:U86"><span class="var type1" id="S7T2U133">N</span>-<span class="mxinfo" id="T2:U88">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,16">16</a></span><span class="line">			<span class="mxinfo" id="T2:U89"><span class="mxinfo" id="T2:U90"><span class="var type1" id="S2T18U138">M</span>(<span class="mxinfo" id="T5:U92"><span class="var type1" id="S16T2U140">nn</span>+<span class="mxinfo" id="T2:U94">1</span></span>,<span class="mxinfo" id="T2:U95"><span class="var type1" id="S13T17U143">xc</span>(<span class="var type1" id="S16T2U144">nn</span>)</span>)</span> = <span class="mxinfo" id="T2:U98">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,17">17</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,18">18</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,19">19</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="49,20">20</a></span><span class="line">	   <span class="keyword">if</span> ((<span class="mxinfo" id="T7:U99"><span class="mxinfo" id="T2:U100"><span class="var type1" id="S8T14U154">thc</span>(<span class="var type1" id="S12T2U155">ll</span>)</span> &lt;= <span class="mxinfo" id="T2:U103"><span class="mxinfo" id="T2:U104">pi</span>/<span class="mxinfo" id="T2:U105">4</span></span></span>) | (<span class="mxinfo" id="T7:U106"><span class="mxinfo" id="T2:U107"><span class="var type1" id="S8T14U163">thc</span>(<span class="var type1" id="S12T2U164">ll</span>)</span> &gt; <span class="mxinfo" id="T2:U110"><span class="mxinfo" id="T2:U111">3*pi</span>/<span class="mxinfo" id="T2:U112">4</span></span></span>))</span></span>
<span class="srcline"><span class="lineno"><a href="49,21">21</a></span><span class="line">	  	  <span class="mxinfo" id="T17:U113"><span class="var type1" id="S17T17U173">yr</span> = <span class="mxinfo" id="T17:U115"><span class="mxinfo" id="T17:U116"><span class="mxinfo" id="T17:U117">round(<span class="mxinfo" id="T17:U118"><span class="mxinfo" id="T2:U119">tan(<span class="mxinfo" id="T2:U120"><span class="var type1" id="S8T14U182">thc</span>(<span class="var type1" id="S12T2U183">ll</span>)</span>)</span>*(<span class="mxinfo" id="T17:U123"><span class="mxinfo" id="T2:U124"><span class="mxinfo" id="T2:U125"><span class="mxinfo" id="T2:U126">-<span class="var type1" id="S7T2U189">N</span></span>/<span class="mxinfo" id="T2:U128">2</span></span>+<span class="mxinfo" id="T2:U129">1</span></span>:<span class="mxinfo" id="T2:U130"><span class="mxinfo" id="T2:U131"><span class="var type1" id="S7T2U194">N</span>/<span class="mxinfo" id="T2:U133">2</span></span>-<span class="mxinfo" id="T2:U134">1</span></span></span>)</span>)</span>+<span class="mxinfo" id="T2:U135"><span class="var type1" id="S7T2U198">N</span>/<span class="mxinfo" id="T2:U137">2</span></span></span>+<span class="mxinfo" id="T2:U138">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,22">22</a></span><span class="line">      	  <span class="keyword">for</span> <span class="var type1" id="S16T2U203">nn</span> = <span class="mxinfo" id="T2:U140">1</span>:<span class="mxinfo" id="T2:U141"><span class="var type1" id="S7T2U207">N</span>-<span class="mxinfo" id="T2:U143">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,23">23</a></span><span class="line">         	<span class="mxinfo" id="T2:U144"><span class="mxinfo" id="T2:U145"><span class="var type1" id="S2T18U212">M</span>(<span class="mxinfo" id="T2:U147"><span class="var type1" id="S17T17U214">yr</span>(<span class="var type1" id="S16T2U215">nn</span>)</span>,<span class="mxinfo" id="T5:U150"><span class="var type1" id="S16T2U217">nn</span>+<span class="mxinfo" id="T2:U152">1</span></span>)</span> = <span class="mxinfo" id="T2:U153">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,24">24</a></span><span class="line">          <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,25">25</a></span><span class="line">       <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="49,26">26</a></span><span class="line">		  <span class="mxinfo" id="T17:U154"><span class="var type1" id="S13T17U223">xc</span> = <span class="mxinfo" id="T17:U156"><span class="mxinfo" id="T17:U157"><span class="mxinfo" id="T17:U158">round(<span class="mxinfo" id="T17:U159"><span class="mxinfo" id="T2:U160">cot(<span class="mxinfo" id="T2:U161"><span class="var type1" id="S8T14U232">thc</span>(<span class="var type1" id="S12T2U233">ll</span>)</span>)</span>*(<span class="mxinfo" id="T17:U164"><span class="mxinfo" id="T2:U165"><span class="mxinfo" id="T2:U166"><span class="mxinfo" id="T2:U167">-<span class="var type1" id="S7T2U239">N</span></span>/<span class="mxinfo" id="T2:U169">2</span></span>+<span class="mxinfo" id="T2:U170">1</span></span>:<span class="mxinfo" id="T2:U171"><span class="mxinfo" id="T2:U172"><span class="var type1" id="S7T2U244">N</span>/<span class="mxinfo" id="T2:U174">2</span></span>-<span class="mxinfo" id="T2:U175">1</span></span></span>)</span>)</span>+<span class="mxinfo" id="T2:U176"><span class="var type1" id="S7T2U248">N</span>/<span class="mxinfo" id="T2:U178">2</span></span></span>+<span class="mxinfo" id="T2:U179">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,27">27</a></span><span class="line">	  	  <span class="keyword">for</span> <span class="var type1" id="S16T2U253">nn</span> = <span class="mxinfo" id="T2:U181">1</span>:<span class="mxinfo" id="T2:U182"><span class="var type1" id="S7T2U257">N</span>-<span class="mxinfo" id="T2:U184">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="49,28">28</a></span><span class="line">		  	<span class="mxinfo" id="T2:U185"><span class="mxinfo" id="T2:U186"><span class="var type1" id="S2T18U262">M</span>(<span class="mxinfo" id="T5:U188"><span class="var type1" id="S16T2U264">nn</span>+<span class="mxinfo" id="T2:U190">1</span></span>,<span class="mxinfo" id="T2:U191"><span class="var type1" id="S13T17U267">xc</span>(<span class="var type1" id="S16T2U268">nn</span>)</span>)</span> = <span class="mxinfo" id="T2:U194">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,29">29</a></span><span class="line">          <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,30">30</a></span><span class="line">       <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,31">31</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,32">32</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,33">33</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,34">34</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,35">35</a></span><span class="line"><span class="comment">% upper half plane mask (not including origin)</span></span></span>
<span class="srcline"><span class="lineno"><a href="49,36">36</a></span><span class="line"><span class="mxinfo" id="T18:U195"><span class="var type1" id="S3T18U272">Mh</span> = <span class="mxinfo" id="T18:U197">zeros(<span class="var type1" id="S7T2U275">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,37">37</a></span><span class="line"><span class="mxinfo" id="T18:U199"><span class="var type1" id="S3T18U278">Mh</span> = <span class="var type1" id="S2T18U279">M</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,38">38</a></span><span class="line"><span class="mxinfo" id="T18:U202"><span class="mxinfo" id="T18:U203"><span class="var type1" id="S3T18U283">Mh</span>(<span class="mxinfo" id="T45:U205"><span class="mxinfo" id="T2:U206"><span class="mxinfo" id="T2:U207"><span class="var type1" id="S7T2U287">N</span>/<span class="mxinfo" id="T2:U209">2</span></span>+<span class="mxinfo" id="T2:U210">2</span></span>:<span class="var type1" id="S7T2U290">N</span></span>,<span class="mxinfo" id="T45:U212">:</span>)</span> = <span class="mxinfo" id="T2:U213">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,39">39</a></span><span class="line"><span class="mxinfo" id="T17:U214"><span class="mxinfo" id="T17:U215"><span class="var type1" id="S3T18U296">Mh</span>(<span class="mxinfo" id="T5:U217"><span class="mxinfo" id="T2:U218"><span class="var type1" id="S7T2U299">N</span>/<span class="mxinfo" id="T2:U220">2</span></span>+<span class="mxinfo" id="T2:U221">1</span></span>,<span class="mxinfo" id="T45:U222"><span class="mxinfo" id="T2:U223"><span class="mxinfo" id="T2:U224"><span class="var type1" id="S7T2U305">N</span>/<span class="mxinfo" id="T2:U226">2</span></span>+<span class="mxinfo" id="T2:U227">1</span></span>:<span class="var type1" id="S7T2U308">N</span></span>)</span> = <span class="mxinfo" id="T2:U229">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,40">40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,41">41</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="49,42">42</a></span><span class="line"><span class="mxinfo" id="T18:U230"><span class="var type1" id="S2T18U312">M</span> = <span class="mxinfo" id="T18:U232">ifftshift(<span class="var type1" id="S2T18U315">M</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,43">43</a></span><span class="line"><span class="mxinfo" id="T19:U234"><span class="var type1" id="S4T19U318">mi</span> = <span class="mxinfo" id="T19:U236">find(<span class="var type1" id="S2T18U321">M</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,44">44</a></span><span class="line"><span class="mxinfo" id="T18:U238"><span class="var type1" id="S3T18U324">Mh</span> = <span class="mxinfo" id="T18:U240">ifftshift(<span class="var type1" id="S3T18U327">Mh</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="49,45">45</a></span><span class="line"><span class="mxinfo" id="T19:U242"><span class="var type1" id="S5T19U330">mhi</span> = <span class="mxinfo" id="T19:U244">find(<span class="var type1" id="S3T18U333">Mh</span>)</span></span>;</span></span>
</pre>
